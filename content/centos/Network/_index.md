+++
title = "Network"
weight = 7
+++

## Network

* nemeserver 설정
```no-highlight
[root@centos7 ~]# vi /etc/resolv.conf
# Generated by NetworkManager
nameserver 8.8.8.8
```

* Network 설정 디렉토리는 다음과 같습니다.  
/etc/sysconfig/network-scripts


{{% notice note %}}
CentOS / RHEL 의 경우 6 Version 이후 부터는 Bios name 을 사용하기 때문에
eth 등이 아닌 ens / em 등으로 나올수 있습니다.
{{% /notice %}}



* DHCP 를 사용할 경우

```no-highlight
[root@centos7 ~]# cd /etc/sysconfig/network-scripts/
[root@centos7 network-scripts]# vi ifcfg-ens33
TYPE=Ethernet
BOOTPROTO=dhcp
NAME=ens33
UUID=adb348b2-1e95-4ebb-ad63-dcbc4e7a7e19
DEVICE=ens33
ONBOOT=yes
```

* Static 을 사용할경우

```no-highlight
TYPE=Ethernet
BOOTPROTO=static
NAME=ens33
UUID=adb348b2-1e95-4ebb-ad63-dcbc4e7a7e19
DEVICE=ens33
ONBOOT=yes
IPADDR=192.168.0.10
NETMASK=255.255.255.0
GATEWAY=192.168.0.2
```

* Bonding 구성

{{% notice note %}}
Network Nic 2중화를 위한 구성이며 2개의 Nic 로 구성합니다.  
아래 구성의 경우 ifcfg-ens33 + ifcfg-ens34 bond0 구성 방법에 대한 소개 입니다.  
ifcfg-ensX file 을 bond0 파일로 Copy 합니다.  
{{% /notice %}}

```no-highlight
[root@centos7 ~]# cd /etc/sysconfig/network-scripts/
[root@centos7 network-scripts]# cp ifcfg-ens33  ifcfg-bond0
BOOTPROTO=static
DEVICE=bond0
ONBOOT=yes
IPADDR=192.168.0.10
NETMASK=255.255.255.0
GATEWAY=192.168.0.2
USERCTL=no
BONDING_OPTS="mode=1 miimon=100"
```
{{% notice tip %}}
bond0 파일의 경우 IP주소 및 Netmask 값 gateway 값을 가지고 있습니다.  
System 에서는 Nic Device 의 경우 Gateway 가 하나만 설정 되어야 합니다.  
Routing 테이블 추가의 경우 다른 페이지에서 소개하겠습니다.  
{{% /notice %}}
<br></br>

* ifcfg-ens33 파일 수정
```no-highlight
[root@centos7 network-scripts]# vi ifcfg-ens33
TYPE=Ethernet
BOOTPROTO=none
DEVICE=ens33
ONBOOT=yes
USERCTL=no
MASTER=bond0
SLAVE=yes
```


* ifcfg-ens34 파일 수정
```no-highlight
[root@centos7 network-scripts]# vi ifcfg-ens34
BOOTPROTO=none
DEVICE=ens34
ONBOOT=yes
USERCTL=no
MASTER=bond0
SLAVE=yes
```

* network daemon 을 재시작 합니다.
```no-highlight
[root@centos7 ~]# systemctl restart network
```

* bonding 구성정보 확인
```no-highlight
[root@centos7 ~]# systemctl restart network
[root@centos7 ~]# cat /proc/net/bonding/bond0
Ethernet Channel Bonding Driver: v3.7.1 (April 27, 2011)

Bonding Mode: fault-tolerance (active-backup)
Primary Slave: None
Currently Active Slave: ens33
MII Status: up
MII Polling Interval (ms): 100
Up Delay (ms): 0
Down Delay (ms): 0

Slave Interface: ens33
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 00:0c:29:c4:d1:c9
Slave queue ID: 0

Slave Interface: ens34
MII Status: up
Speed: 1000 Mbps
Duplex: full
Link Failure Count: 0
Permanent HW addr: 00:0c:29:c4:d1:d3
```

{{% notice tip %}}
bonding 구성정보 확인시 ens33 , ens34 로 bond0 이 구성된 것을 확인할수 있습니다.  
Active 된 Nic 의 경우 Currently Active Slave 에서 확인 할수 있습니다.  
{{% /notice %}}

<br></br>
